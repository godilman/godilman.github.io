<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Grup Oluşturucu</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { padding: 2rem; }
    .group-card { margin-bottom: 1rem; }
    .group-card pre { white-space: pre-wrap; }
  </style>
</head>
<body>
  <div class="container">
    <h3 class="mb-3">Kişi Listesi</h3>
    <textarea id="nameInput" class="form-control mb-3" rows="10"></textarea>
    <label for="groupSizeSelect" class="form-label">Grup Kişi Sayısı</label>
    <select id="groupSizeSelect" class="form-select mb-3"></select>
    <button id="groupBtn" class="btn btn-primary mb-4">Grupla</button>
    <div id="groupCards" class="row"></div>
  </div>

  <script>
      // Dummy isimleri yükle
      window.addEventListener("DOMContentLoaded", () => {
const dummyNames = `BÜLENT ÖCAL
TOLGA SAYLAN
SEDAT ERDOĞAN
MUSTAFA ERİK
YALÇIN SERTEL
FATMA HANDAN KULA
İMREN GÖZTAŞ
MEHMET BALCI
ÇETİN KıCıR
SÜLEYMAN TANOĞLU
OGÜN İŞGÜZAR
SELÇUK ORAL
YASİN ATGÜDEN
HÜSEYİN SOYGÜDER
FERDİ ASLAN
MURAT ARSLAN
TURAN ÖZGAN
SABİT KONAKCİ
BERAT KARACAOĞLU
KEMAL KORKUSUZ
BAHAR AYDIN BAYDIK
EMİN YİĞİT KOSOVA
SÜLEYMAN GÖZTAŞ
İSA BAL
NURCAN YILDIRIM
COŞKUN AÇIKGÖZ
AHMET CENK ÇİVİCİ
ZEKİ ŞAHİNGÖZ
HULUSİ GÜNAYDIN
BURCU ÖZDEMİR
ALİ BÜYÜKGENÇOĞLU
AYŞE YAMAN
ATAKAN ARSLAN
GÖKHAN DİLMAN
FATİH ÖLÇER
AYŞEN ALBAYRAK
EMRE KANTAR
HAKAN ÇAĞLAYAN
MEHMET ÇİL
RAMAZAN SOYGÜDER
ÖMER OKTAY TUNCAY
İHSAN YÜREKLİ
ZEYNEP HARMANCI BİLGİN
MEHMET RAMAZAN TEMUÇİN
VEHBİ YILMAZ
PELİN SOYGÜDER
YAĞMUR BİLİR
EYÜP FUAT KILIÇ
FATMA TOPALOĞLU
MUSTAFA YAYLAGÜL
OĞUZ YÜKSEL
HALİL İBRAHİM ŞEVİK
ABDULLAH KOZAK
HÜSEYİN KUTAY MEMİŞ
ZEKİYE KOÇ
ELİF KOÇ
EMRE KAVAK
GÖKÇE KAVAK
FATİH ÜRKMEZ
MEHMET CEYLAN
PINAR TUFAN
ERHAN KOZ
EMRE AKÇAPINAR
MUSTAFA AKKUŞ
SALMAN BARIŞ ÖZVEREN
NUSRET GÜNCÜR
ALKETA GÜRSEL
UĞUR ARDIÇ
CAN ASLAN
DENİZ ÖZDAMAR
CANSU UYSAL
ŞEYHMUS KOŞAR
SRIRAM RAMACHANDRAN
KAZIM MURAT KAMIŞLI
DİLAN VARGELOĞLU
HİMMET KARAARSLAN
MEHMET YURDAKUL
HASAN COŞKU GÜLSEVEN
ZEYNEL KILIÇASLAN
SALİHA BAYİN DOĞDU
HÜSEYİN TARHAN
ÖMER ŞEMSEDDİN KARGI
MERT CAN ÖZER
DEFNE ERYÜCEL
FADİME BOZKURT
MAHİR KARASU
ELİF ERGİNSOY
MUHAMMET KEYDAL
GÜLÇİN TARHAN
CİHAD BERKTEL
MESUT ÖZTÜRK
TUTKU TÜRKMEN
KEMAL ŞAHİN
KARDELEN ELVEREN
ERKAN ALA
RIDVAN KARAKAŞ
YAPRAK YİĞİT
ÖMER FARUK ÖZTÜRK
CÜNEYT AYAZ
ÖMER BERKAY DÜNDAR
AHMET AKIN
EMRE ÖZGENÇ
EMRULLAH BUYURMAN
AHMET CAN ONARAN
İBRAHİM ERGÜL
ARİFE ÇETİN
İSMAİL BUDAK
ERCAN TUNALI
YILMAZ ALTUN
AHMET SEMERCİOĞLU
TAHSİN ÖRSAN ÖCALAN
ZEYNEP ZAZA
AHMET MERMER
HAKAN GELEN
JITENDRA SAVE
BURAK ARSLAN
İSMAİL ULUDAĞ
UTKU SÖYÜNMEZ
MUSTAFA BÜLBÜL
AYCAN BARAN
ENİS ÇAKMAK
NEHİR ELGÜN ARSLAN
HÜSEYİN YUMRUKAYA
HANDE UÇAR
ŞURA TÜTÜNCÜ
ALPER BALCI
MEHMET ÖZGÜN
HAZAR ŞURA EKİZOĞLU
BEHLÜL BERK GÜNEY
CANALP BAYBÖRÜ
DORUK DİLAVER MALGİR
HASAN BASRİ KARAARSLAN
AYŞE KANDEMİR
ALİ GÜLMEZ
İNCİ SÜDEMEN
ZEYNEP DİLHAN ÇILKADAROĞLU
MUSA BERKİTEN
EDA NİLAY SEYHAN
NAZLI ECEM COŞKUNTÜRK
GÖZDE GENCEL
OĞUZ TEKİNER
İSMET KARAKAŞ
KAZIM MURAT YILDIRIM
BATIN ERKAN PUŞULU
MUSTAFA ÇORUMLU
EMRE ERDAL
HATİCE GİZEM BÜTÜN
MISRA SÖYLEMEZ
İSMAİL KAYA
GİZEM ÇELİK
EMRE ALTINKAYA
ÖZLEM KILIÇ
BERKER KARAGÖZ
ELÇİN ÖZGENÇ
NİHAN PERİHAN
HAZAL ORMAN PARLAK
ARMAĞAN ALTINOK
MUHAMMED GAZİ YILMAZ
ERGÜL GAYTANLI HACIBAYRAM
ARİF YAŞAR ŞAHİN
MUHAMMED SENİH TATLI
BURAK YALÇIN
ANIL YİĞİT ÖZENÇ
ZEYNEP SEYHAN
MUHAMMED EMRAH SAVAR
EMİRHAN ŞAHİN
EYÜPHAN SAZ
BATUHAN YAĞMUR
CAN UYAN`.split('\n');
  document.getElementById("nameInput").value = dummyNames.join("\n");
  updateGroupSizes();
    });

    function normalize(name) {
      return name.trim().toLocaleLowerCase('tr').replace(/\s+/g, ' ');
    }

    function getDivisors(n) {
      let result = [];
      for (let i = 2; i <= n / 2; i++) {
        if (n % i === 0 && n / i >= 2) result.push(i);
      }
      return result;
    }

    function updateGroupSizes() {
      const names = getNames();
      const groupSizeSelect = document.getElementById("groupSizeSelect");
      groupSizeSelect.innerHTML = "";
      const divisors = getDivisors(names.length);
      divisors.forEach(size => {
        const opt = document.createElement("option");
        opt.value = size;
        opt.textContent = `${size} kişilik gruplar`;
        groupSizeSelect.appendChild(opt);
      });
    }


    function getNames() {
      return document.getElementById("nameInput").value
        .split("\n")
        .map(line => line.trim())
        .filter(Boolean);
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }
    //
    function groupNames() {
  const rawNames = getNames();
  let people = rawNames.map(n => ({ raw: n, norm: normalize(n) }));

  const defne = people.find(p => p.norm === "defne eryücel");
  const gokhan = people.find(p => p.norm === "gökhan dilman");

  const kutays = people.filter(p =>
    p.norm.startsWith("kutay ") ||
    p.norm === "kutay" ||
    p.norm.includes(" kutay") ||
    p.norm.split(" ").includes("kutay")
  );

  if (!(defne && gokhan)) {
    people = people.filter(p => p.norm !== "defne eryücel" && p.norm !== "gökhan dilman");
  }

  const groupSize = parseInt(document.getElementById("groupSizeSelect").value);
  const totalGroups = Math.ceil(people.length / groupSize);
  const groups = Array.from({ length: totalGroups }, () => []);

  shuffle(people);

  let defneGokhanGroupIndex = -1;

  if (defne && gokhan) {
    people = people.filter(p => p.norm !== defne.norm && p.norm !== gokhan.norm);

    // Defne ve Gökhan'ı koymak için uygun grup bul
    const candidateIndexes = groups
      .map((_, i) => i)
      .filter(i => groups[i].length <= groupSize - 2);

    shuffle(candidateIndexes);

    for (const index of candidateIndexes) {
      const group = groups[index];
      const hasKutay = group.some(p => kutays.find(kp => kp.norm === p.norm));
      if (!hasKutay) {
        group.push(defne, gokhan);
        defneGokhanGroupIndex = index;
        break;
      }
    }
  }

  // Kalan kişileri sırayla dağıt
  let idx = 0;
  people.forEach(p => {
    if (kutays.find(k => k.norm === p.norm)) {
      // Kutay ise Defne-Gökhan grubuna koyma
      let placed = false;
      for (let i = 0; i < groups.length; i++) {
        if (i === defneGokhanGroupIndex) continue;
        if (groups[i].length < groupSize) {
          groups[i].push(p);
          placed = true;
          break;
        }
      }
      if (!placed) {
        // Zorla atama
        for (let i = 0; i < groups.length; i++) {
          if (i !== defneGokhanGroupIndex) {
            groups[i].push(p);
            break;
          }
        }
      }
    } else {
      // Normal kişiler
      while (groups[idx].length >= groupSize) idx = (idx + 1) % groups.length;
      groups[idx].push(p);
    }
  });

  groups.forEach(group => group.sort((a, b) => a.raw.localeCompare(b.raw)));
  renderGroups(groups);
}


    
function renderGroups(groups) {
  const container = document.getElementById("groupCards");
  container.innerHTML = "";
  groups.forEach((group, i) => {
    const col = document.createElement("div");
    col.className = "col-md-4 group-card";

    // İsimleri numaralı ve Defne-Gökhan kırmızı olarak hazırla
    const namesWithNumbers = group.map((p, index) => {
      const name = `${index + 1}- ${p.raw}`;
      if (p.norm === "defne eryücel" || p.norm === "gökhan dilman") {
        return `<span style="">${name}</span>`;
      }
      return name;
    }).join("\n");

    col.innerHTML = `
      <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
          <strong>Grup ${i + 1}</strong>
          <button class="btn btn-sm btn-outline-secondary" onclick="copyGroup(${i})">Kopyala</button>
        </div>
        <div class="card-body">
          <pre id="group-${i}">${namesWithNumbers}</pre>
        </div>
      </div>`;
    container.appendChild(col);
  });
}

    function copyGroup(i) {
      const text = document.getElementById(`group-${i}`).innerText;
      navigator.clipboard.writeText(text);
    }

    document.getElementById("groupBtn").addEventListener("click", groupNames);
    document.getElementById("nameInput").addEventListener("input", updateGroupSizes);

    updateGroupSizes();
  </script>
</body>
</html>
